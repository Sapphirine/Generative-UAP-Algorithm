# Count the number of images fooled by a % of a permutation class
SELECT 
  Count,
  COUNT(*) as Total
FROM 
(
  SELECT 
    ImgId,
    COUNT(CASE WHEN Class != PertClass THEN 1 END) as Count
    From Project.Test 
  WHERE 
    PertType = "TypeV"
  GROUP BY 
    ImgId
)
Group BY
  Count
ORDER BY
  Count

# How many did each perturbation fool?
SELECT 
  PertId,
  COUNT(CASE WHEN Class != PertClass THEN 1 END) as Fooled,
  COUNT(CASE WHEN Class = PertClass THEN 1 END) as NotFooled
  From Project.Test 
WHERE 
  PertType = "TypeV"
GROUP BY 
  PertId

# How many of each image class were fooled?
SELECT 
  Class,
  COUNT(CASE WHEN Class != PertClass THEN 1 END) as Fooled,
  COUNT(CASE WHEN Class = PertClass Then 1 END) as NotFooled
  From Project.Test 
WHERE 
  PertType = "TypeV"
GROUP BY 
  Class